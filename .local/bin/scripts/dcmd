#!/bin/bash

cmds=(
  # "btmirecon"
  # "btmidis"
  # "btamrecon"
  # "btamdis"
  "btjblrecon"
  "btjbldis"
  "austream"
  "remodbt"
  "warp"
)

ch=$(printf '%s\n' "${cmds[@]}" | dmenu -p "cmd")

case $ch in
  btmirecon) bt mi r ;;
  btmidis) bt mi d ;;
  btamrecon) bt am r ;;
  btamdis) bt am d ;;
  btjblrecon) bt jbl r ;;
  btjbldis) bt jbl d ;;
  austream)
    if [[ $(austream status) == "off" ]]; then
      austream on
    else
      austream off
    fi
    notify-send "audio streaming is $(austream status)"
    ;;
  "") exit 0 ;;
  remodbt)
    sudo modprobe -r btusb
    sudo modprobe btusb
    sudo systemctl restart bluetooth.service
    ;;
  warp)
    status=$(warp-cli status | awk '/Status/ {print $3}')
    if [[ $status == "Connected" ]]; then
      warp-cli disable-always-on
    else
      warp-cli enable-always-on
    fi
    ;;
  *) notify-send "unknown dcmd: $ch"; exit 1 ;;
esac
